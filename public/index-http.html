<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" >
		var Vector2D = function(x,y) {
			this.x = x;
			this.y = y;
		}

		Vector2D.prototype.magnitude = function() {
			return Math.sqrt(((this.x * this.x) + (this.y * this.y)));
		};
	</script>
	<script type="text/javascript" src='/socket.io/socket.io.js'></script>
	<script type="text/javascript">
		//var socket = io.connect('partyhorse.zapto.org:8080/'/* using the default namespace */),
		var socket = io.connect(),
			v      = new Vector2D(0,0);

		socket.on('new user', function(data) {
			console.log('event: new user',data);

			var p   = document.getElementById("count");
			p.innerHTML = "(" + data + ") connections";
		});


		socket.on('xmit', function(vector) {
			console.log('event: xmit',vector);

			v.x = vector.x;
			v.y = vector.y;
			v.currMag = v.magnitude();

			socket.emit('vecUpdate',v);
		});

		socket.on('same', function(vector) {
			var p = document.getElementById('xmit-data');
			p.innerHTML = "Vector: " + vector.x + " -- " + vector.y + " with Magnitude -- " + vector.currMag;

			console.log(vector.message);
		});

		socket.on('not same', function(vector) {
			var p = document.getElementById('xmit-data');
			p.innerHTML = "Vector: " + vector.message;

			console.log(vector.message);
		});

		socket.on('ready', function() {
			socket.emit('get user name');
		});

		window.addEventListener('load', function(ev) {
			document.getElementById('submit-username').addEventListener('click', function(ev) {
				var entry = document.getElementById('username-input');

				socket.emit('set user name', entry.value);
			});
		});

	</script>
</head>
<body>
<div style="text-align: center; width: 1000px; margin: 0 auto;">
	<h3>This is a socket test!</h3>
	<!--<p>Here's a cool Animation -- Archimedes' Spiral</p>
	<iframe width="100%" height="300" src="http://jsfiddle.net/theoperatore/cKVu8/embedded/result,js,html/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>-->
	<input id='username-input' type='text' placeholder='Enter a UserName'>
	<input id='submit-username' type='button' value='Submit'>
</div>

<div id='log' style="text-align: center;">
	<p id='count'></p>
</div>
<div id='xmit-log' style="width:500px; margin: 0 auto; background-color: #ebebeb">
	<p id='xmit-data'></p>
</div>	
</body>
</html>
